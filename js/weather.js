document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("weatherWidget"),t=document.querySelector(".site-header"),n=document.querySelector(".hero");if(e&&t){let r=()=>{let n=window.innerWidth<=768,r=n?80:t.offsetHeight+20;e.style.top=`${r}px`};r(),window.addEventListener("resize",r)}async function o(){try{let t=await fetch("https://weather.zonkeynet.workers.dev/"),n=await t.json();if(!n.weather||!n.weather[0])throw Error("Dati meteo non validi");let r=n.weather[0].icon,o=Math.round(n.main.temp);document.getElementById("weatherIcon").src=`https://openweathermap.org/img/wn/${r}@2x.png`,document.getElementById("weatherTemp").textContent=`${o}\xb0C`,e.classList.remove("hidden")}catch(i){console.error("Errore meteo:",i),e&&e.classList.add("hidden")}}if(o(),e&&n){let i=new IntersectionObserver(([t])=>{let n=t.isIntersecting;e.style.opacity=n?"1":"0",e.style.pointerEvents=n?"auto":"none"},{root:null,threshold:.2});i.observe(n)}});